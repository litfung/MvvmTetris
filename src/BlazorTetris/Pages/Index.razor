@page "/"


@using BlazorTetris.ViewModels


@functions
{
    public GameViewModel Game { get; } = new GameViewModel();


    protected override void OnInit()
    {
        this.Game.Field.TetriminoMoved.Subscribe(_ => this.StateHasChanged());
        this.Game.Play();
    }
}



<table border="1" class="field">
    <tbody>
        @{
            var cells = this.Game.Field.Cells;
            var rowCount = cells.GetLength(0);
            var columnCount = cells.GetLength(1);

            for (var r = 0; r < cells.GetLength(0); r++)
            {
                <tr>
                    @for (var c = 0; c < columnCount; c++)
                    {
                        var color = cells[r, c].Color.Value;
                        var rgb = $"rgb({color.R}, {color.G}, {color.A})";
                        <td style="background-color: @rgb"></td>
                    }
                </tr>
            }
        }
    </tbody>
</table>